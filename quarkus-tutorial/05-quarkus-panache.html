<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Build Database Interactive Applications :: Quarkus Tutorial</title>
    <link rel="canonical" href="https://redhat-developer-demos.github.io/quarkus-tutorial/quarkus-tutorial/05-quarkus-panache.html">
    <meta name="generator" content="Antora 2.3.1">
    <link rel="stylesheet" href="../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://developers.redhat.com" target="_blank"><img src="../_/img/NewRHDFullLogo_4-color_white-wordmark.png" height="40px" alt="Red Hat Developer Program"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="https://redhat-developer-demos.github.io/quarkus-tutorial">Quarkus Tutorial</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://developers.redhat.com/ebooks/" target="_blank">Books</a>
        <a class="navbar-item" href="https://developers.redhat.com/cheatsheets/" target="_blank">Cheat Sheets</a>
        <a class="navbar-item" href="https://developers.redhat.com/events/" target="_blank">Upcoming Events</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">More Tutorials</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/kubernetes-tutorial/" target="_blank">Kubernetes</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/istio-tutorial/" target="_blank">Istio</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/quarkus-tutorial/" target="_blank">Quarkus</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/knative-tutorial/" target="_blank">Knative</a>
            <a class="navbar-item" href="https://redhat-developer-demos.github.io/tekton-tutorial/" target="_blank">Tekton</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="quarkus-tutorial" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html"></a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="01-setup.html">Setup</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="01-setup.html#requirements">Required Tools</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="02-basics-fundas.html">Basics and Fundamentals</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-basics-fundas.html#basics-create-quarkus-app">Create Quarkus Application</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-basics-fundas.html#basics-ide-quarkus-project">Open Application in IDE</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-basics-fundas.html#basics-build-run-quarkus-app">Build and Run Application</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-basics-fundas.html#basics-update-code">Update Code</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-basics-fundas.html#basics-call-svc">Invoke Service</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="02-basics-fundas.html#basics-testing">Testing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="02-basics-fundas.html#basics-logging">Configuring Logging</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="02-basics-fundas.html#basics-call-svc-logging">Invoke Service</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="02-basics-fundas.html#basics-configuration">Configuration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="02-basics-fundas.html#basics-configuration-new-property">Add New Property</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="02-basics-fundas.html#basics-configuration-get-value">Get Configuration Value</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="02-basics-fundas.html#basics-call-configuration">Invoke Service</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="05-quarkus-panache.html">Hibernate with Quarkus</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#quarkusp-demo-overview">Demo Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="#quarkusp-fruitapp-dev">Build and Deploy</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#quarkus-fruit-app-db">Deploy Mariadb</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#quarkusp-access-db">Access Database </a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#quarkuspdb-update-props">Configure Application properties</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#quarkusp-create-fruit-entity">Create Fruit Entity</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#quarkusp-edit-fruit-resource">Update Fruit Resource</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="#quarkusp-fruits-finder">Finders</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="04-quarkus-extensions.html">Quarkus Extensions</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-quarkus-extensions.html#qext-intro">What are Extensions ?</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="04-quarkus-extensions.html#qext-list-extensions">List Extensions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="04-quarkus-extensions.html#qext-rest-client">Rest Client</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-quarkus-extensions.html#qext-add-rest-client-extensions">Adding Rest Client extension</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-quarkus-extensions.html#qext-create-fruity-vice-pojo">Creating FruityVice POJO</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-quarkus-extensions.html#qext-create-fruity-vice-service">Creating FruityVice Service</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-quarkus-extensions.html#qext-create-fruity-vice-service-config">Configuring FruityVice Service</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-quarkus-extensions.html#qext-create-fruity-vice-service-resclient">Using the RestClient</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-quarkus-extensions.html#qext-rest-client-run-quarkus-app-dev-mode">Run Quarkus Application in Development mode</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-quarkus-extensions.html#qext-call-fruity-rest-client">Invoke Service</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="04-quarkus-extensions.html#qext-fault-tolerance">Fault Tolerance</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-quarkus-extensions.html#qext-add-fault-tolerance-extensions">Adding Fault Tolerance extension</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-quarkus-extensions.html#qext-retry-fruity-vice-service">Add Retry to Fruity Vice Service</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-quarkus-extensions.html#qext-fault-tolerance-run-quarkus-app-dev-mode">Run Quarkus Application in Development mode</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-quarkus-extensions.html#qext-call-fruity-fault-tolerance-retry">Invoke Service</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-quarkus-extensions.html#qext-fallback-fruity-vice-service">Add Fallback to Fruity Vice Service</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-quarkus-extensions.html#qext-fault-tolerance-fallback-run-quarkus-app-dev-mode">Run Quarkus Application in Development mode</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-quarkus-extensions.html#qext-call-fruity-fault-tolerance-fallback">Invoke Service</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-quarkus-extensions.html#qext-circuit-breaker-fruity-vice-service">Add Ciruict Breaker to Fruity Vice Service</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-quarkus-extensions.html#qext-circuit-breaker-run-quarkus-app-dev-mode">Run Quarkus Application in Development mode</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-quarkus-extensions.html#qext-call-fruity-fault-tolerance-circuit-breaker">Invoke Service</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-quarkus-extensions.html#qext-turn-on-network">Turn Network On</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="04-quarkus-extensions.html#qext-health-checks">Health Checks</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-quarkus-extensions.html#qext-add-extensions">Add Extension</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-quarkus-extensions.html#qext-health-check-default-run-quarkus-app-dev-mode">Run Quarkus Application in Development mode</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-quarkus-extensions.html#qext-call-health-ep">Invoke Health Endpoint</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-quarkus-extensions.html#qext-custom-health-check">Customizing Health Checks</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-quarkus-extensions.html#qext-health-check-custom-run-quarkus-app-dev-mode">Run Quarkus Application in Development mode</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-quarkus-extensions.html#qext-call-health-custom">Invoke Health Endpoint</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-quarkus-extensions.html#qext-health-checks-kubernetes">Add Health Probes to Kubernetes Application</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="04-quarkus-extensions.html#qext-jwt">Securing endpoints with JWT</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-quarkus-extensions.html#qext-add-jwt-extensions">Add Extension</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-quarkus-extensions.html#qext-configure-jwt-parameters">Configuring JWT parameters</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-quarkus-extensions.html#qext-jwt-inject-claim">Injecting Claims</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-quarkus-extensions.html#qext-jwt-claim-quarkus-app-dev-mode">Run Quarkus Application in Development mode</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-quarkus-extensions.html#qext-call-jwt-claim">Invoke Endpoint</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-quarkus-extensions.html#qext-jwt-inject-rbac">Add RBAC</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="04-quarkus-extensions.html#qext-call-jwt-rbac">Invoke Endpoint</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="06-quarkus-reactive.html">Reactive Programming with Quarkus</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="06-quarkus-reactive.html#quarkusrpb-demo-overview">Beer Demo Overview</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="06-quarkus-reactive.html#quarkusrpb-buld-beer-reactive">Build Beer Service</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="06-quarkus-reactive.html#qext-reactive-beer-run-quarkus-app-dev-mode">Run Quarkus Application with Beer Service</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">quarkus-tutorial</a></li>
    <li><a href="05-quarkus-panache.html">Hibernate with Quarkus</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/redhat-developer-demos/quarkus-tutorial/edit/master/documentation/modules/ROOT/pages/05-quarkus-panache.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">Build Database Interactive Applications</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>At the end of this chapter you will be able to :</p>
</div>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-check-square-o"></i> What is Panache ?</p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> How to build a Hibernate application using Panache?</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="quarkusp-demo-overview"><a class="anchor" href="#quarkusp-demo-overview"></a>Demo Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You&#8217;ll learn how easy and productive is Quarkus with Hibernate with Panache. For this, we&#8217;ll developer an application called "Fruits". It&#8217;s a simple CRUD REST API that handles information about fruits.</p>
</div>
<div class="paragraph">
<p>We&#8217;ll use <a href="http://www.h2database.com">H2</a> as our backing database, but it&#8217;s very easy to use other database engines with Quarkus. As an exercise for later, we suggest you to try your favorite database engine with the documentation found <a href="https://quarkus.io/guides/datasource">here</a>.</p>
</div>
<div class="sect3">
<h4 id="_build_fruit_resource"><a class="anchor" href="#_build_fruit_resource"></a>Build Fruit Resource</h4>
<div class="paragraph">
<p>The skeleton project to get started is the same you created at <a href="02-basics-fundas.html" class="page">Basics and Fundamentals</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For the easier reference, we shall call the <code>fruits-app</code> project folder as $PROJECT_HOME
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="quarkusp-add-persistence-extensions"><a class="anchor" href="#quarkusp-add-persistence-extensions"></a>Add Extensions</h5>
<div id="qext-mvn-add-persistence-extensions" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw quarkus:add-extension -Dextension="quarkus-resteasy-jsonb, quarkus-jdbc-h2, quarkus-hibernate-orm-panache, quarkus-smallrye-openapi"</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="quarkusp-configure-props"><a class="anchor" href="#quarkusp-configure-props"></a>Edit the application.properties</h5>
<div class="paragraph">
<p>Add the following properties to <code>$PROJECT_HOME/src/main/resources/application.properties</code>:</p>
</div>
<div id="quarkuspdb-update-props" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-config hljs" data-lang="config">quarkus.datasource.url=jdbc:h2:mem:default
quarkus.datasource.driver=org.h2.Driver
quarkus.datasource.username=username-default
quarkus.datasource.min-size=3
quarkus.datasource.max-size=13
quarkus.hibernate-orm.database.generation=drop-and-create
quarkus.hibernate-orm.log.sql=true</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_test_database_connection"><a class="anchor" href="#_test_database_connection"></a>Test Database connection</h5>
<div class="paragraph">
<p>Let&#8217;s start Quarkus in <code>development</code> mode to verify the database connection works:</p>
</div>
<div id="quarkuspdb-test-dbconn" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-config hljs" data-lang="config">./mvnw compile quarkus:dev</code></pre>
</div>
</div>
<div class="paragraph">
<p>If all went well then you should be seeing something like the following in the log:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">Listening for transport dt_socket at address: 5005
2020-02-18 09:57:23,827 WARN  [io.qua.agr.dep.AgroalProcessor] (build-23) Agroal dependency is present but no driver has been defined for the default datasource
2020-02-18 09:57:25,322 INFO  [io.quarkus] (main) devnexus 1.0-SNAPSHOT (running on Quarkus 1.2.0.Final) started in 2.287s. Listening on: http://0.0.0.0:8080
2020-02-18 09:57:25,324 INFO  [io.quarkus] (main) Profile dev activated. Live Coding activated.
2020-02-18 09:57:25,324 INFO  [io.quarkus] (main) Installed features: [agroal, cdi, hibernate-orm, hibernate-orm-panache, jdbc-h2, narayana-jta, resteasy, resteasy-jsonb, smallrye-openapi, swagger-ui]</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you would have noticed there is no database logs. That&#8217;s because we dont have any database related code yet:</p>
</div>
</div>
<div class="sect4">
<h5 id="quarkusp-create-fruit-entity"><a class="anchor" href="#quarkusp-create-fruit-entity"></a>Create Fruit Entity</h5>
<div class="paragraph">
<p>Add new Java file in <code>$PROJECT_HOME/src/main/java/com/example</code> called <code>Fruit</code> with the following contents:</p>
</div>
<div id="quarkusp-fruit-entity" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package com.example;

import javax.persistence.Entity;

@Entity
public class Fruit {

    public String name;

    public String season;

}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="quarkusp-edit-fruit-resource"><a class="anchor" href="#quarkusp-edit-fruit-resource"></a>Update Fruit Resource</h5>
<div class="paragraph">
<p>Edit the Java file <code>$PROJECT_HOME/src/main/java/com/example/FruitResource.java</code>, remove <code>hello()</code> method and add a new REST method to get all the available fruits:</p>
</div>
<div id="quarkusp-fruit-entity1" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package com.example;

import java.util.List;

import javax.ws.rs.GET;
import javax.ws.rs.Path;
import javax.ws.rs.Produces;
import javax.ws.rs.core.MediaType;

@Path("/fruit")
public class FruitResource {

    @GET
    @Produces(MediaType.APPLICATION_JSON)
    public List&lt;Fruit&gt; fruits() {
        return Fruit.listAll();
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Your IDE will show an errors in <code>FruitResource.java</code> as it does not have a method <code>listAll()</code> in <code>Fruit</code> entity class.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Do I need to add it ? The simple answer is <strong>NO</strong>.</p>
</div>
</div>
<div class="sect4">
<h5 id="quarkusp-what-is-panache"><a class="anchor" href="#quarkusp-what-is-panache"></a>Make Fruit Entity a Panache Entity</h5>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><strong>What is Panache ?</strong></p>
</div>
<div class="paragraph">
<p>Hibernate ORM is the de facto JPA implementation and offers you the full breadth of an Object Relational Mapper. It makes complex mappings possible, but it does not make simple and common mappings trivial. Hibernate ORM with Panache focuses on making your entities trivial and fun to write in Quarkus.</p>
</div>
<div class="paragraph">
<p>More info <a href="https://quarkus.io/guides/hibernate-orm-panache-guide">Panache Guide</a></p>
</div>
</div>
</div>
<div id="quarkusp-fruit-entity2" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package com.example;

import javax.persistence.Entity;
import io.quarkus.hibernate.orm.panache.PanacheEntity;

@Entity
public class Fruit extends PanacheEntity {

    public String name;

    public String season;

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Making the <code>Fruit</code> entity as a <code>Panache Entity</code> will make it both Entity and DAO and ofcourse the error in the <code>FruitResource.java</code> disappears.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s now access the Fruits API <a href="http://localhost:8080/fruit" class="bare">http://localhost:8080/fruit</a>. If all goes well you will see some Hibernate SQL statements in the log that will create the new table <code>Fruit</code> with columns from <code>Fruit.java</code> entity class.</p>
</div>
<div class="paragraph">
<p>Since we don&#8217;t have any fruits in the DB you would have got an empty response back.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s add a REST method to the <code>FruitResource.java</code> to save a 'Fruit':</p>
</div>
<div id="quarkusp-fruit-add-persist" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package com.example;

import java.util.List;

import javax.transaction.Transactional;
import javax.ws.rs.Consumes;
import javax.ws.rs.GET;
import javax.ws.rs.POST;
import javax.ws.rs.Path;
import javax.ws.rs.PathParam;
import javax.ws.rs.Produces;
import javax.ws.rs.core.MediaType;
import javax.ws.rs.core.Response;
import javax.ws.rs.core.Response.Status;

@Path("/fruit")
public class FruitResource {

    @GET
    @Produces(MediaType.APPLICATION_JSON)
    public List&lt;Fruit&gt; fruits() {
        return Fruit.listAll();
    }

    @POST
    @Produces(MediaType.APPLICATION_JSON)
    @Consumes(MediaType.APPLICATION_JSON)
    @Transactional
    public Response newFruit(Fruit fruit) {
        fruit.id = null;
        fruit.persist();
        return Response.status(Status.CREATED).entity(fruit).build();
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can insert a new fruit by using the next <code>curl</code> command: <code>curl -vvv -d '{"name": "Banana", "season": "Summer"}' -H "Content-Type: application/json" POST <a href="http://localhost:8080/fruit" class="bare">http://localhost:8080/fruit</a></code></p>
</div>
<div class="paragraph">
<p>Or use the Swagger UI at <a href="http://localhost:8080/swagger-ui" class="bare">http://localhost:8080/swagger-ui</a> to try your REST endpoints.</p>
</div>
<div class="paragraph">
<p>Try adding a fruit via the Swagger UI Post and try listing the available fruits. You will see a JSON response like this one:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
    "name": "Banana",
    "season": "Summer"
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The response may vary based on which fruits you added.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="quarkusp-fruits-finder"><a class="anchor" href="#quarkusp-fruits-finder"></a>Finders</h5>
<div class="paragraph">
<p>Cool! So far we did with some primitive methods lets explore some cool things that Panache offers.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s try to find all fruits by a season. To make the query return some data let us add some fruits to the DB.</p>
</div>
<div class="paragraph">
<p>Create the following <code>import.sql</code> file in <code>$PROJECT_HOME/src/main/resources</code>:</p>
</div>
<div id="quarkusp-add-fruits" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">INSERT INTO Fruit(id,name,season) VALUES (nextval('hibernate_sequence'),'Mango','Spring');
INSERT INTO Fruit(id,name,season) VALUES (nextval('hibernate_sequence'),'Strawberry','Spring');
INSERT INTO Fruit(id,name,season) VALUES (nextval('hibernate_sequence'),'Orange','Winter');
INSERT INTO Fruit(id,name,season) VALUES (nextval('hibernate_sequence'),'GrapeFruit','Winter');
INSERT INTO Fruit(id,name,season) VALUES (nextval('hibernate_sequence'),'Blueberry','Summer');
INSERT INTO Fruit(id,name,season) VALUES (nextval('hibernate_sequence'),'Banana','Summer');
INSERT INTO Fruit(id,name,season) VALUES (nextval('hibernate_sequence'),'Plum','Summer');
INSERT INTO Fruit(id,name,season) VALUES (nextval('hibernate_sequence'),'Apple','Fall');
INSERT INTO Fruit(id,name,season) VALUES (nextval('hibernate_sequence'),'Grapes','Fall');</code></pre>
</div>
</div>
<div class="paragraph">
<p>Update <code>Fruit</code> entity to add a finder method like:</p>
</div>
<div id="quarkusp-find-fruits" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package com.example;

import java.util.List;
import javax.persistence.Entity;
import io.quarkus.hibernate.orm.panache.PanacheEntity;

@Entity
public class Fruit extends PanacheEntity {

    public String name;

    public String season;

    public static List&lt;Fruit&gt; getAllFruitsForSeason(String season) {
        return find("season", season).list();
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Update <code>FruitResource</code> by adding a REST endpoint to get fruits by season:</p>
</div>
<div id="quarkusp-get-find-fruits" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package com.example;

import java.util.List;

import javax.transaction.Transactional;
import javax.ws.rs.Consumes;
import javax.ws.rs.GET;
import javax.ws.rs.POST;
import javax.ws.rs.Path;
import javax.ws.rs.PathParam;
import javax.ws.rs.Produces;
import javax.ws.rs.core.MediaType;
import javax.ws.rs.core.Response;
import javax.ws.rs.core.Response.Status;

@Path("/fruit")
public class FruitResource {

    @GET
    @Produces(MediaType.APPLICATION_JSON)
    public List&lt;Fruit&gt; fruits() {
        return Fruit.listAll();
    }

    @GET
    @Produces(MediaType.APPLICATION_JSON)
    @Path("/{season}")
    public List&lt;Fruit&gt; fruitsBySeason(@PathParam("season") String season) {
        return Fruit.getAllFruitsForSeason(season);
    }

    @POST
    @Produces(MediaType.APPLICATION_JSON)
    @Consumes(MediaType.APPLICATION_JSON)
    @Transactional
    public Response newFruit(Fruit fruit) {
        fruit.id = null;
        fruit.persist();
        return Response.status(Status.CREATED).entity(fruit).build();
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To test finder use the Swagger UI <a href="http://localhost:8080/swagger-ui" class="bare">http://localhost:8080/swagger-ui</a>.</p>
</div>
<div class="paragraph">
<p>A finder for fruits for the <em>Summer</em> season should return a response like :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">[
  {
    "id": 5,
    "name": "Blueberry",
    "season": "Summer"
  },
  {
    "id": 6,
    "name": "Banana",
    "season": "Summer"
  },
  {
    "id": 7,
    "name": "Plum",
    "season": "Summer"
  }
]</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="quarkusp-testing"><a class="anchor" href="#quarkusp-testing"></a>Testing Fruit Resource</h4>
<div class="paragraph">
<p>Let&#8217;s write a test to validate that inserting and finding methods works as expected.</p>
</div>
<div class="sect4">
<h5 id="quarkusp-testing-dep"><a class="anchor" href="#quarkusp-testing-dep"></a>Adding AssertJ Dependency</h5>
<div class="paragraph">
<p>To validate simple output messages RestAssured assertions mechanism is enough but in our experience, when start dealing with more complex assertions then things might become a bit more complex.
For this reason, we encourage you to start using <a href="https://assertj.github.io/doc/">AssertJ</a>.</p>
</div>
<div class="paragraph">
<p>Open <code>$PROJECT_HOME/pom.xml</code> and add the following dependencies in the <code>dependencies</code> section:</p>
</div>
<div id="quarkusp-register-assertj" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.assertj&lt;/groupId&gt;
    &lt;artifactId&gt;assertj-core&lt;/artifactId&gt;
    &lt;version&gt;3.13.2&lt;/version&gt;
    &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
    &lt;artifactId&gt;quarkus-test-h2&lt;/artifactId&gt;
    &lt;version&gt;1.2.0.Final&lt;/version&gt;
    &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="quarkusp-write-persistence-test"><a class="anchor" href="#quarkusp-write-persistence-test"></a>Write Persistence Test</h5>
<div class="paragraph">
<p>Open the next class <code>$PROJECT_HOME/src/test/java/com/example/FruitResourceTest.java</code> and copy the next content:</p>
</div>
<div id="quarkusp-test-class" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package com.example;

import static io.restassured.RestAssured.given;
import static org.assertj.core.api.Assertions.assertThat;

import java.util.List;

import org.junit.jupiter.api.MethodOrderer.OrderAnnotation;
import org.junit.jupiter.api.Order;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.TestMethodOrder;

import io.quarkus.test.common.QuarkusTestResource;
import io.quarkus.test.h2.H2DatabaseTestResource;
import io.quarkus.test.junit.QuarkusTest;

@QuarkusTest
@TestMethodOrder(OrderAnnotation.class)
@QuarkusTestResource(H2DatabaseTestResource.class)
public class FruitResourceTest {

    @Test
    @Order(1)
    public void testInsertFruit() {
        Fruit fruit = new Fruit();
        fruit.name = "Watermelon";
        fruit.season = "Summer";

        given()
          .contentType("application/json")
          .body(fruit)
          .when()
          .post("/fruit")
          .then()
          .assertThat()
          .statusCode(201);
    }

    @Test
    @Order(2)
    public void testFindFruitsBySeason() {
        final List&lt;Fruit&gt; fruits = given()
          .when()
          .get("/fruit/{season}", "Summer")
          .then()
          .assertThat()
          .statusCode(200)
          .extract()
          .body()
          .jsonPath()
          .getList(".", Fruit.class);

        assertThat(fruits)
            .extracting("name")
            .containsExactlyInAnyOrder("Banana", "Watermelon", "Plum", "Blueberry");
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When running this test, the application is started once, then all tests are executed, and finally, the application is stopped.
Although it is not mandatory, by default <a href="http://rest-assured.io/">RestAssured</a> project is used to test Rest endpoints but it is up to you to change that.</p>
</div>
<div class="paragraph">
<p>You can run the test either in IDE or by running Maven:</p>
</div>
<div id="basics-run-tests" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw clean compile test</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <a class="rhd-logo" href="https://developers.redhat.com" target="_blank"></div>
</footer>
<script src="../_/js/vendor/clipboard.js"></script>
<script src="../_/js/site.js"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>
